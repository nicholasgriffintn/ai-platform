{
	"name": "assistant",
	"main": "src/index.ts",
	"compatibility_date": "2025-05-05",
	"compatibility_flags": [
		"nodejs_compat",
		"nodejs_compat_populate_process_env"
	],
	"workers_dev": false,
	"preview_urls": false,
	"placement": {
		"mode": "smart"
	},
	"observability": {
		"enabled": true,
		"head_sampling_rate": 0.1,
		"logs": {
			"enabled": true,
			"head_sampling_rate": 0.1,
			"invocation_logs": false
		}
	},
	"routes": [
		{
			"pattern": "api.polychat.app",
			"zone_name": "polychat.app",
			"custom_domain": true,
		},
	],
	"dev": {
		"port": 8787
	},
	"vars": {
		"ACCOUNT_ID": "REPLACE_ME",
		"APP_BASE_URL": "REPLACE_ME",
		"SES_EMAIL_FROM": "REPLACE_ME",
		"PUBLIC_ASSETS_URL": "REPLACE_ME",
		"PUBLIC_ASSETS_BUCKET": "assistant-assets",
		"REQUIRE_CAPTCHA_SECRET_KEY": "false",
		"ALWAYS_ENABLED_PROVIDERS": "workers-ai,mistral,deepseek,google-ai-studio",
		"LOG_LEVEL": "warn",
		"ENV": "production",
		"EMAIL_PROVIDER": "aws_ses"
	},
	"ai": {
		"binding": "AI",
		"remote": true
	},
	"vectorize": [
		{
			"binding": "VECTOR_DB",
			"index_name": "polychat",
			"remote": true
		}
	],
	"services": [
		{
			"binding": "SANDBOX_WORKER",
			"service": "assistant-sandbox-worker"
		}
	],
	"analytics_engine_datasets": [
		{
			"binding": "ANALYTICS",
			"dataset": "assistant_analytics"
		}
	],
	"r2_buckets": [
		{
			"binding": "ASSETS_BUCKET",
			"bucket_name": "assistant-assets",
			"preview_bucket_name": "assistant-assets",
			"remote": true
		}
	],
	"d1_databases": [
		{
			"binding": "DB",
			"database_name": "personal-assistant",
			"database_id": "REPLACE_ME",
			"preview_database_id": "REPLACE_ME"
		},
		{
			"binding": "PREVIEW_DB",
			"database_name": "personal-assistant-preview",
			"database_id": "REPLACE_ME"
		}
	],
	"kv_namespaces": [
		{
			"binding": "CACHE",
			"id": "REPLACE_ME",
			"preview_id": "REPLACE_ME"
		}
	],
	"ratelimits": [
			{
				"name": "FREE_RATE_LIMITER",
				"namespace_id": "1001",
				"simple": {
					"limit": 60,
					"period": 60,
				},
			},
			{
				"name": "PRO_RATE_LIMITER",
				"namespace_id": "1002",
				"simple": {
					"limit": 120,
					"period": 60,
				},
			},
  ],
	"triggers": {
		"crons": ["0 2 * * *", "0 3 * * *"],
	},
	"queues": {
		"producers": [{ "binding": "TASK_QUEUE", "queue": "polychat-task-queue" }],
		"consumers": [
			{
				"queue": "polychat-task-queue",
				"max_batch_size": 10,
				"dead_letter_queue": "polychat-task-queue-dlq",
			},
		]
	}
}
